# server/src/graphql/schemas/client.graphql

enum ClientType {
  RESIDENTIAL
  COMMERCIAL
  OTHER
}

type Client {
  id: ID!
  businessId: ID!
  firstName: String!
  lastName: String!
  businessName: String
  email: String
  phone: String
  type: ClientType!
  notes: String

  addresses: [Address!]!
  projects: [Project!]!
  invoices: [Invoice!]!

  createdAt: DateTime!
  updatedAt: DateTime!
  deletedAt: DateTime
}

input CreateClientInput {
  businessId: ID!
  firstName: String!
  lastName: String!
  businessName: String
  email: String
  phone: String
  type: ClientType = RESIDENTIAL
  notes: String

  addresses: [CreateAddressInput!]
}

input UpdateClientInput {
  firstName: String
  lastName: String
  businessName: String
  email: String
  phone: String
  type: ClientType
  notes: String

  addresses: [CreateAddressInput!]
}

# (Reusing CreateAddressInput from your existing setup is fine, 
# assuming it handles the mapping in the resolver)
input CreateAddressInput {
  addressType: AddressType = CLIENT_BUSINESS
  line1: String!
  line2: String
  city: String!
  state: String
  postcode: String!
  country: String
  countryCode: String
}

extend type Query {
  clients(businessId: ID!): [Client!]!
  client(id: ID!): Client
}

extend type Mutation {
  createClient(input: CreateClientInput!): Client!
  updateClient(id: ID!, input: UpdateClientInput!): Client!
  deleteClient(id: ID!): Client!
}